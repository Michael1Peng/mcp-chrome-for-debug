# Chrome-MCP-服务器架构概览

## 核心架构

```
┌─────────────────────────────────────────────────────────────────┐
│                     Chrome-MCP-服务器架构                      │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────┐    Native Messaging    ┌──────────────────┐ │
│  │  Chrome扩展程序 │ ◄───────────────────► │ Native主机服务器  │ │
│  │                 │                        │                  │ │
│  │  Background:    │                        │  Node.js Server: │ │
│  │  • MCP工具调用  │                        │  • Fastify HTTP  │ │
│  │  • 浏览器API    │                        │  • MCP协议处理   │ │
│  │  • 语义搜索     │                        │  • SSE传输       │ │
│  │  • 存储管理     │                        │  • HTTP传输      │ │
│  │                 │                        │                  │ │
│  │  Content:       │                        │                  │ │
│  │  • 页面注入     │                        │                  │ │
│  │  • DOM交互      │                        │                  │ │
│  │                 │                        │                  │ │
│  │  Popup:         │                        │                  │ │
│  │  • Vue3界面     │                        │                  │ │
│  └─────────────────┘                        └──────────────────┘ │
│           │                                           │           │
│           └─────────────── WebSocket/HTTP ────────────┘           │
│                                                                   │
└─────────────────────────────────────────────────────────────────┘
```

## 技术栈架构

```
┌─────────────────────────────────────────────────────────────────┐
│                        技术栈分层                                │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│ 客户端层:                                                       │
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ Chrome扩展 (WXT框架)                                        │ │
│ │ • Vue 3 + TypeScript                                       │ │
│ │ • @xenova/transformers (语义搜索)                          │ │
│ │ • hnswlib-wasm-static (向量数据库)                         │ │
│ │ • Chrome APIs (tabs, storage, scripting)                  │ │
│ └─────────────────────────────────────────────────────────────┘ │
│                                 │                               │
│                        Native Messaging                        │
│                                 │                               │
│ 服务端层:                                                       │
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ Node.js 原生主机                                            │ │
│ │ • Fastify (HTTP服务器)                                      │ │
│ │ • @modelcontextprotocol/sdk (MCP协议)                      │ │
│ │ • CORS支持 + 多传输协议 (HTTP/SSE)                         │ │
│ └─────────────────────────────────────────────────────────────┘ │
│                                 │                               │
│ 共享层:                                                         │
│ ┌─────────────────────────────────────────────────────────────┐ │
│ │ chrome-mcp-shared                                           │ │
│ │ • TypeScript类型定义                                        │ │
│ │ • Zod验证                                                   │ │
│ │ • MCP SDK集成                                               │ │
│ └─────────────────────────────────────────────────────────────┘ │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```
